(function(){async function i(){try{await n.start();n.invoke("LoadMessages")}catch(t){console.error(t);setTimeout(i,5e3)}}function r(n,i){t++;var r="";r+="<div id='cm-msg-"+t+"' class=\"chat-msg "+i+'">';r+='          <div class="cm-msg-text">';r+=u(n);r+="          <\/div>";r+="        <\/div>";$(".chat-logs").append(r);$("#cm-msg-"+t).hide().fadeIn(300);i=="self"&&$("#chat-input").val("");$(".chat-logs").stop().animate({scrollTop:$(".chat-logs")[0].scrollHeight},1e3)}function u(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var n=(new signalR.HubConnectionBuilder).withUrl("/chat").build(),t;n.onclose(i);i();t=0;$("#chat-submit").click(function(t){t.preventDefault();var i=$("#chat-input").val();if(i.trim()=="")return!1;n.invoke("Send",i)});n.on("NewMessage",function(n){if(Array.isArray(n)){$(".chat-logs").val("");for(var t=0;t<n.length;t++)r(n[t].message,"self")}else r(n.message,"self")});$("#chat-circle").click(function(){$("#chat-circle").toggle("scale");$(".chat-box").toggle("scale");$(".chat-logs").stop().animate({scrollTop:$(".chat-logs")[0].scrollHeight},1e3)});$(".chat-box-toggle").click(function(){$("#chat-circle").toggle("scale");$(".chat-box").toggle("scale")})})();